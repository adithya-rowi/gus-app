<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gus App - AI Content Generation</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <span class="brand-icon" data-feather="zap"></span>
                <span class="brand-text">Gus App</span>
            </div>
            <div class="nav-status">
                <div class="status-item {% if api_status.deepseek %}status-active{% else %}status-inactive{% endif %}">
                    <span data-feather="cpu"></span>
                    <span>DeepSeek</span>
                </div>
                <div class="status-item {% if api_status.ragie %}status-active{% else %}status-inactive{% endif %}">
                    <span data-feather="database"></span>
                    <span>Ragie</span>
                </div>
            </div>
        </div>
    </nav>

    <main class="main-container">
        <div class="app-layout">
            <aside class="input-panel">
                <div class="panel-header">
                    <h2>
                        <span data-feather="edit-3"></span>
                        Generate Content
                    </h2>
                </div>

                <div class="form-section">
                    <label class="form-label" for="persona-select">
                        <span data-feather="user"></span>
                        Persona
                    </label>
                    <select id="persona-select" class="form-select">
                        {% for persona in personas %}
                        <option value="{{ persona.id }}">{{ persona.name }}</option>
                        {% endfor %}
                    </select>
                    <p class="form-helper" id="persona-description">Select a persona to define the writing style</p>
                </div>

                <div class="form-section custom-prompt-section" id="custom-prompt-section" style="display: none;">
                    <label class="form-label" for="custom-prompt">
                        <span data-feather="settings"></span>
                        Custom Instructions
                    </label>
                    <textarea id="custom-prompt" class="form-textarea" rows="3" placeholder="Define your custom persona instructions..."></textarea>
                </div>

                <div class="form-section">
                    <label class="form-label" for="prompt-input">
                        <span data-feather="message-square"></span>
                        Your Prompt
                    </label>
                    <textarea id="prompt-input" class="form-textarea" rows="6" placeholder="What would you like to generate?"></textarea>
                    <div class="char-count"><span id="char-count">0</span> characters</div>
                </div>

                <div class="form-section ragie-section">
                    <div class="toggle-row">
                        <label class="toggle-label">
                            <input type="checkbox" id="use-ragie" class="toggle-checkbox">
                            <span class="toggle-switch"></span>
                            <span>Use Knowledge Base (Ragie)</span>
                        </label>
                    </div>
                    <div id="ragie-query-section" class="ragie-query-section" style="display: none;">
                        <input type="text" id="ragie-query" class="form-input" placeholder="Search query for knowledge base...">
                    </div>
                </div>

                <details class="settings-accordion">
                    <summary>
                        <span data-feather="sliders"></span>
                        Advanced Settings
                    </summary>
                    <div class="settings-content">
                        <div class="setting-row">
                            <label for="temperature">Temperature: <span id="temp-value">0.7</span></label>
                            <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7">
                        </div>
                        <div class="setting-row">
                            <label for="max-tokens">Max Tokens: <span id="tokens-value">2000</span></label>
                            <input type="range" id="max-tokens" min="100" max="4000" step="100" value="2000">
                        </div>
                    </div>
                </details>

                <div class="button-group">
                    <button id="generate-btn" class="btn btn-primary">
                        <span data-feather="send"></span>
                        Generate
                    </button>
                </div>
            </aside>

            <section class="output-panel">
                <div class="panel-header">
                    <h2>
                        <span data-feather="file-text"></span>
                        Output
                    </h2>
                    <div class="output-actions" id="output-actions" style="display: none;">
                        <button id="copy-btn" class="btn btn-icon" title="Copy to clipboard">
                            <span data-feather="copy"></span>
                        </button>
                        <button id="critique-btn" class="btn btn-secondary">
                            <span data-feather="message-circle"></span>
                            Critique
                        </button>
                    </div>
                </div>

                <div class="output-content" id="output-content">
                    <div class="empty-state" id="empty-state">
                        <span data-feather="edit" class="empty-icon"></span>
                        <h3>No content yet</h3>
                        <p>Enter a prompt and click Generate to create content</p>
                    </div>
                    <div class="generated-content" id="generated-content" style="display: none;">
                        <div class="content-text" id="content-text"></div>
                        <div class="content-meta" id="content-meta"></div>
                    </div>
                    <div class="loading-state" id="loading-state" style="display: none;">
                        <div class="spinner"></div>
                        <p id="loading-message">Generating content...</p>
                    </div>
                </div>

                <div class="critique-section" id="critique-section" style="display: none;">
                    <div class="critique-header">
                        <h3>
                            <span data-feather="message-circle"></span>
                            Critique
                        </h3>
                        <button id="close-critique" class="btn btn-icon">
                            <span data-feather="x"></span>
                        </button>
                    </div>
                    <div class="critique-content" id="critique-content"></div>
                    <div class="critique-actions">
                        <button id="refine-btn" class="btn btn-primary">
                            <span data-feather="refresh-cw"></span>
                            Refine Content
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <div class="toast-container" id="toast-container"></div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
    <script>
        feather.replace();
    </script>
</body>
</html>
